List.update_at<A: Type>(idx: Nat, fn: A -> A, xs: List<A>): List<A>
  case xs {
    nil: List.nil!
    cons: case idx{
      zero: List.cons!(fn(xs.head), xs.tail)
      succ: List.cons!(xs.head, List.update_at<A>(idx.pred, fn, xs.tail))
    }
  }